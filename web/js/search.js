"use strict";var search;$(document).ready(function(){var e=$("#find"),t=$("#query"),a=t.attr("data-placeholder"),s=$("#launch"),n=$("#aggressive"),i=$("#searchTypeCheckbox"),l=$("#options"),r=$("#advanced,#hideMisere"),o=$("a.btns"),c=$(".searchForIt"),d=$("#alerts"),h=$("span.closeHelp"),u=$("span.closeForever"),p=$("#resetQuery"),f=$("#results"),m=$("#results ul"),v=$(".nbResults"),g=$("#waiting"),k=($("a.tPagerNext img, a.tPagerPrev img, .tPagerPage"),"");s.removeAttr("disabled"),o.removeAttr("on"),"function"==typeof $.iphoneStyle&&(n.iphoneStyle({checkedLabel:n.attr("data-yes"),uncheckedLabel:n.attr("data-no"),resizeContainer:!1,resizeHandle:!1}),i.iphoneStyle({checkedLabel:"",uncheckedLabel:"",resizeContainer:!1,resizeHandle:!1,containerClass:"iPhoneCheckContainer otherContainer",labelOnClass:"iPhoneCheckLabelOn albums",labelOffClass:"iPhoneCheckLabelOff tracks",handleClass:"iPhoneCheckHandle otherHandle",handleCenterClass:"iPhoneCheckHandleCenter noBG",handleRightClass:"iPhoneCheckHandleRight activeTracks",containerRadius:2,onChange:function(){var e;i.is(":checked")?($("#typeTracks").removeClass("off"),$("#typeAlbums").addClass("off"),$(".iPhoneCheckHandleRight.activeAlbums").addClass("activeTracks"),$(".iPhoneCheckHandleRight.activeAlbums").removeClass("activeAlbums"),e="tuneefySearchType=tracks; ",e+="expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";",document.cookie=e):($("#typeTracks").addClass("off"),$("#typeAlbums").removeClass("off"),$(".iPhoneCheckHandleRight.activeTracks").addClass("activeAlbums"),$(".iPhoneCheckHandleRight.activeTracks").removeClass("activeTracks"),e="tuneefySearchType=albums; ",e+="expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";",document.cookie=e)}})),$(document).on("click",".closeAlert",function(){$(this).parent().fadeOut()});var C=document.cookie.split("tuneefyPrefs=")[1]||"";C=""===C?$default_platforms:decodeURIComponent(C.split(";")[0]),k=C;var y=C.split(",");$.each(y,function(e,t){$("#platform_"+t).attr("on","yes").removeClass("off")}),null!==(C=document.cookie.split("tuneefySearchType=")[1]||"")&&"albums"===C.split(";")[0]&&i.click(),search=function(e,a,n){console.log("Searching for "+n.itemType+"s with query '"+a+"' on "+n.selectedPlatforms+" (strict: "+n.strictMode+").");var i={q:a,aggressive:n.strictMode,include:n.selectedPlatforms,limit:n.limit?n.limit:10};e=e+"?"+$.param(i);$.get({url:e,crossDomain:!0,beforeSend:function(e){e.setRequestHeader("X-Requested-With","XMLHttpRequest")},xhrFields:{withCredentials:!0}}).done(function(e){if(e.errors&&e.errors.length>0){for(var t=0;t<e.errors.length;t++)d.append("<span class='alert' ><div class=\"triangle\"></div>"+Object.values(e.errors[0])[0]+"<span class='closeAlert'></span></span>");d.children().last().fadeIn()}e.results?(n.updateNumberLabel&&v.html($results_found.replace("%query%",a).replace("%type%",n.itemType).replace("%number%",e.results.length)),$(".tHeader_disp[rel="+n.itemType+"]").show(),Twig.twig({href:"js/twig/result.html.twig",async:!0,load:function(t){for(var a in e.results){var s=e.results[a];m.append(t.render({type:n.itemType,item:s.musical_entity,intent:s.share.intent,share:$share,listenTo:$listen_to.replace("%name%",s.musical_entity.safe_title),shareTip:$share_tip.replace("%name%",s.musical_entity.safe_title),linkDirect:$path,linkIntent:$pathIntent,compact:!0}))}f.show()}})):(d.append("<span class='alert' ><div class=\"triangle\"></div>"+$error_message+"<span class='closeAlert'></span></span>"),d.children().last().fadeIn())}).fail(function(){d.append("<span class='alert' ><div class=\"triangle\"></div>"+$error_message+"<span class='closeAlert'></span></span>"),d.children().last().fadeIn()}).always(function(){g.hide(),s.removeAttr("disabled"),t.blur(),m.length>0&&$("html,body").animate({scrollTop:m.offset().top-20},"slow")})},e.submit(function(o){o.preventDefault(),$(".hideAll").fadeOut(),r.hide(),l.removeClass("shd");var c=$.trim(t.val()),h=n.is(":checked"),u=i.is(":checked")?"track":"album";if(""===c||c===a||""===k)return!1;s.attr("disabled","disabled"),f.hide(),m.find(".tResult").remove(),g.show(),d.empty(),$(".tHeader_disp").hide();var p=e.attr("action").replace("%type%",u);search(p,c,{itemType:u,selectedPlatforms:k,strictMode:h,updateNumberLabel:!0})}),t.click(function(e){t.val()===a&&t.val(""),$(e.target).select(),$("#basic").addClass("focused"),$(".hideAll").fadeTo(500,.5),null===document.cookie.split("tuneefyHelpBox=")[1]&&$("#help").fadeIn(),e.stopPropagation()}),c.click(function(a){t.val($(a.target).html()),e.submit()}),t.keyup(function(){t.val()!==a&&0!==$.trim(t.val()).length?p.show():p.hide()}),p.click(function(e){t.val(""),t.focus(),p.hide(),e.stopPropagation()}),h.click(function(e){$("#help").fadeOut(),t.focus(),e.stopPropagation()}),u.click(function(e){var a="tuneefyHelpBox=neverAgain; ";a+="expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";",document.cookie=a,$("#help").fadeOut(),t.focus(),e.stopPropagation()}),l.click(function(e){r.toggle(),l.toggleClass("shd"),e.stopPropagation()}),$(".hideAll").click(function(){}),$("html").click(function(){r.hide(),l.removeClass("shd"),$("#basic").removeClass("focused"),$(".hideAll").fadeOut(),$("#help").fadeOut(),""===t.val()&&t.val(a)}),r.click(function(e){e.stopPropagation()}),o.click(function(e){"yes"===$(e.target).attr("on")?($(e.target).attr("on","no"),$(e.target).addClass("off")):($(e.target).attr("on","yes"),$(e.target).removeClass("off"));var t=[];o.each(function(){"yes"===$(this).attr("on")&&t.push($(this).attr("rel"))}),k=t.toString();var a="tuneefyPrefs="+encodeURIComponent(k)+"; expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";";document.cookie=a}),$(document).on("click",".sharePage",function(){var e=$(this).attr("data-href");$.get({url:e,crossDomain:!0,beforeSend:function(e){e.setRequestHeader("X-Requested-With","XMLHttpRequest")},xhrFields:{withCredentials:!0}}).done(function(e){e.link&&(window.location.href=e.link)}).fail(function(){}).always(function(){})});var b=$(".pick"),P=$(".pickPagerItem");P.length>0&&P.first().addClass("active"),b.length>1&&setInterval(function(){var e=b.filter(":visible"),t=P.filter(".active"),a=e.next(),s=t.next();0==a.length&&(a=b.first(),s=P.first()),a.css("left","400px"),a.show(),a.animate({left:"30px"},"slow"),e.animate({left:"-300px"},"slow"),e.fadeOut("slow"),t.removeClass("active"),s.addClass("active")},4e3)});