(function(){var u,p=Array.prototype.slice;function a(e,i){var t,n,s;for(t in this.elem=$(e),n=$.extend({},a.defaults,i))s=n[t],this[t]=s;this.elem.data(this.dataName,this),this.wrapCheckboxWithDivs(),this.attachEvents(),this.disableTextSelection(),this.resizeHandle&&this.optionallyResize("handle"),this.resizeContainer&&this.optionallyResize("container"),this.initialPosition()}null==$.browser&&(userAgent=navigator.userAgent||"",$.uaMatch=function(e){var i;return e=e.toLowerCase(),{browser:(i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(e)||[])[1]||"",version:i[2]||"0"}},matched=$.uaMatch(userAgent),$.browser={},matched.browser&&($.browser[matched.browser]=!0,$.browser.version=matched.version),$.browser.webkit&&($.browser.safari=!0)),a.prototype.isDisabled=function(){return this.elem.is(":disabled")},a.prototype.wrapCheckboxWithDivs=function(){return this.elem.wrap("<div class='"+this.containerClass+"' />"),this.container=this.elem.parent(),this.offLabel=$("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container),this.offSpan=this.offLabel.children("span"),this.onLabel=$("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container),this.onSpan=this.onLabel.children("span"),this.handle=$("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' />\n  </div>\n</div>").appendTo(this.container)},a.prototype.disableTextSelection=function(){if($.browser.msie)return $([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on")},a.prototype._getDimension=function(e,i){return null!=$.fn.actual?e.actual(i):e[i]()},a.prototype.optionallyResize=function(e){var i,t,n;return n=this._getDimension(this.onLabel,"width"),t=this._getDimension(this.offLabel,"width"),"container"===e?(i=t<n?n:t,i+=this._getDimension(this.handle,"width")+this.handleMargin,this.container.css({width:i})):(i=t<n?n:t,this.handle.css({width:i}))},a.prototype.onMouseDown=function(e){var i;if(e.preventDefault(),!this.isDisabled())return i=e.pageX||e.originalEvent.changedTouches[0].pageX,a.currentlyClicking=this.handle,a.dragStartPosition=i,a.handleLeftOffset=parseInt(this.handle.css("left"),10)||0},a.prototype.onDragMove=function(e,i){var t,n;if(a.currentlyClicking===this.handle)return(n=(i+a.handleLeftOffset-a.dragStartPosition)/this.rightSide)<0&&(n=0),1<n&&(n=1),t=n*this.rightSide,this.handle.css({left:t}),this.onLabel.css({width:t+this.handleRadius}),this.offSpan.css({marginRight:-t}),this.onSpan.css({marginLeft:-(1-n)*this.rightSide})},a.prototype.onDragEnd=function(e,i){var t;if(a.currentlyClicking===this.handle&&!this.isDisabled())return a.dragging?(t=(i-a.dragStartPosition)/this.rightSide,this.elem.prop("checked",.5<=t)):this.elem.prop("checked",!this.elem.prop("checked")),a.currentlyClicking=null,a.dragging=null,this.didChange()},a.prototype.refresh=function(){return this.didChange()},a.prototype.didChange=function(){var e;return"function"==typeof this.onChange&&this.onChange(this.elem,this.elem.prop("checked")),this.isDisabled()?(this.container.addClass(this.disabledClass),!1):(this.container.removeClass(this.disabledClass),e=this.elem.prop("checked")?this.rightSide:0,this.handle.animate({left:e},this.duration),this.onLabel.animate({width:e+this.handleRadius},this.duration),this.offSpan.animate({marginRight:-e},this.duration),this.onSpan.animate({marginLeft:e-this.rightSide},this.duration))},a.prototype.attachEvents=function(){var i,t,n;return i=function(e){return n.onGlobalMove.apply(n,arguments)},t=function(e){return n.onGlobalUp.apply(n,arguments),$(document).unbind("mousemove touchmove",i),$(document).unbind("mouseup touchend",t)},(n=this).elem.change(function(){return n.refresh()}),this.container.bind("mousedown touchstart",function(e){return n.onMouseDown.apply(n,arguments),$(document).bind("mousemove touchmove",i),$(document).bind("mouseup touchend",t)})},a.prototype.initialPosition=function(){var e,i;if(e=this._getDimension(this.container,"width"),this.offLabel.css({width:e-this.containerRadius}),i=this.containerRadius+1,$.browser.msie&&$.browser.version<7&&(i-=3),this.rightSide=e-this._getDimension(this.handle,"width")-i,this.elem.is(":checked")?(this.handle.css({left:this.rightSide}),this.onLabel.css({width:this.rightSide+this.handleRadius}),this.offSpan.css({marginRight:-this.rightSide})):(this.onLabel.css({width:0}),this.onSpan.css({marginLeft:-this.rightSide})),this.isDisabled())return this.container.addClass(this.disabledClass)},a.prototype.onGlobalMove=function(e){var i;if(!this.isDisabled()&&a.currentlyClicking)return e.preventDefault(),i=e.pageX||e.originalEvent.changedTouches[0].pageX,!a.dragging&&Math.abs(a.dragStartPosition-i)>this.dragThreshold&&(a.dragging=!0),this.onDragMove(e,i)},a.prototype.onGlobalUp=function(e){var i;if(a.currentlyClicking)return e.preventDefault(),i=e.pageX||e.originalEvent.changedTouches[0].pageX,this.onDragEnd(e,i),!1},a.defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:!0,resizeContainer:!0,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerRadius:5,dataName:"iphoneStyle",onChange:function(){}},u=a,$.iphoneStyle=this.iOSCheckbox=u,$.fn.iphoneStyle=function(){var e,i,t,n,s,a,h,o,l,r,d,c;for(t=null!=(l=null!=(r=(e=1<=arguments.length?p.call(arguments,0):[])[0])?r.dataName:void 0)?l:u.defaults.dataName,h=0,o=(d=this.filter(":checkbox")).length;h<o;h++)i=d[h],null!=(n=$(i).data(t))?(s=e[0],a=2<=e.length?p.call(e,1):[],null!=(c=n[s])&&c.apply(n,a)):new u(i,e[0]);return this},$.fn.iOSCheckbox=function(e){var i;return null==e&&(e={}),i=$.extend({},e,{resizeHandle:!1,disabledClass:"iOSCheckDisabled",containerClass:"iOSCheckContainer",labelOnClass:"iOSCheckLabelOn",labelOffClass:"iOSCheckLabelOff",handleClass:"iOSCheckHandle",handleCenterClass:"iOSCheckHandleCenter",handleRightClass:"iOSCheckHandleRight",dataName:"iOSCheckbox"}),this.iphoneStyle(i)}}).call(this);